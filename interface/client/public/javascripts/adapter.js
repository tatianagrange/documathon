function trace(e){if(e[e.length-1]=="\n"){e=e.substring(0,e.length-1)}console.log((performance.now()/1e3).toFixed(3)+": "+e)}var RTCPeerConnection=null;var getUserMedia=null;var attachMediaStream=null;var reattachMediaStream=null;var webrtcDetectedBrowser=null;var webrtcDetectedVersion=null;if(navigator.mozGetUserMedia){console.log("This appears to be Firefox");webrtcDetectedBrowser="firefox";webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]);RTCPeerConnection=mozRTCPeerConnection;RTCSessionDescription=mozRTCSessionDescription;RTCIceCandidate=mozRTCIceCandidate;getUserMedia=navigator.mozGetUserMedia.bind(navigator);createIceServer=function(e,t,n){var r=null;var i=e.split(":");if(i[0].indexOf("stun")===0){r={url:e}}else if(i[0].indexOf("turn")===0&&(e.indexOf("transport=udp")!==-1||e.indexOf("?transport")===-1)){var s=e.split("?");r={url:s[0],credential:n,username:t}}return r};attachMediaStream=function(e,t){console.log("Attaching media stream");e.mozSrcObject=t;e.play()};reattachMediaStream=function(e,t){console.log("Reattaching media stream");e.mozSrcObject=t.mozSrcObject;e.play()};MediaStream.prototype.getVideoTracks=function(){return[]};MediaStream.prototype.getAudioTracks=function(){return[]}}else if(navigator.webkitGetUserMedia){console.log("This appears to be Chrome");webrtcDetectedBrowser="chrome";webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]);createIceServer=function(e,t,n){var r=null;var i=e.split(":");if(i[0].indexOf("stun")===0){r={url:e}}else if(i[0].indexOf("turn")===0){if(webrtcDetectedVersion<28){var s=e.split("turn:");r={url:"turn:"+t+"@"+s[1],credential:n}}else{r={url:e,credential:n,username:t}}}return r};RTCPeerConnection=webkitRTCPeerConnection;getUserMedia=navigator.webkitGetUserMedia.bind(navigator);attachMediaStream=function(e,t){if(typeof e.srcObject!=="undefined"){e.srcObject=t}else if(typeof e.mozSrcObject!=="undefined"){e.mozSrcObject=t}else if(typeof e.src!=="undefined"){e.src=URL.createObjectURL(t)}else{console.log("Error attaching stream to element.")}};reattachMediaStream=function(e,t){e.src=t.src};if(!webkitMediaStream.prototype.getVideoTracks){webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks};webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}}if(!webkitRTCPeerConnection.prototype.getLocalStreams){webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams};webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams}}}else{console.log("Browser does not appear to be WebRTC-capable")}